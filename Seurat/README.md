# Seurat pipeline
我们使用Seurat包(版本4.1.1)进行后续分析，读入稀疏矩阵并转换为Seurat对象，合并所有单细胞基因表达数据。接着，由于低质量细胞或空液滴通常只能检测到非常少的基因，两个或多个细胞被同时捕获通常会有很高的基因数，低质量和濒死细胞常表现出广泛的线粒体污染，所以需要过滤转录组数据。根据图1-1A、B确定阈值，筛选出基因数为500-10，000，UMI计数为1000-100，000、线粒体读数的分数小于30%的细胞。根据图1-1C、D可以看到经过滤后，随着测序深度的增加，测得特征基因和UMI计数相关性更强，说明去除了低质量的细胞、空液滴和含多个细胞的液滴。线粒体基因比例低且分布均匀，说明过滤掉了低质量、濒死以及破损的细胞。 \
![1-1]() \
过滤后，使用具有3000个可变特征的SCTransform对UMI计数进行方差稳定，同时回归出UMI的总数和线粒体转录物含量的比例。为了降低单细胞数据集的维数，在集成数据矩阵上进行了主成分分析（PCA）。选取最优的主成分数需要满足主成分累积贡献大于90%，PC本身对方差贡献小于5%，两个连续PCs之间差异小于0.1%。图1-2A在Eblow图中，经13个PC之后，显著性大幅下降，也就是前13个维度包含了大部分的样本信息。如图1-2B所示，在Heatmap图中，以PCA分数排序的基因和细胞可视化选定PC的最变异基因。观察不同PC的重要性，查看基因差异是否明显，找到热图开始区分不明显的PC数。综合以上方法，选择15个主成成分作为参数用于后续分析。 \
![1-2]() \
主细胞簇通过Seurat提供的FindClusters功能进行识别，分辨率的设置由clustrees图和ROGUE图确定。如图1-3A所示，通过这个图我们会发现当resolution大于0.2后，不同cluster在不同的分辨率下会存在越来越多的相互交织，这暗示着我们可能存在分群过度的情况了，所以在这里我们可以选择0.2作为初步的分群resolution来进行后面的分析。图1-3B使用ROUGE验证我们的分群效果，一个细胞类群的ROGUE值表征了该细胞类群的“纯度”：越接近于1表示细胞类群越“纯”。可以看到分群效果很好，因此确定resolution为0.2。 \
![1-3]() \
然后用2D的tSNE或UMAP图将它们可视化。tSNE图的细胞聚类更为紧凑，但不能反映全剧结构。UMAP图中除聚类外，整体结构反映了细胞间的真实距离，计算速度更快。由于细胞数量较多，使用UMAP图进行结果展示。利用 FindMarkers 命令，可以找到找到各个细胞类型中与其他类别的差异表达基因，作为该细胞类型的生物学标记基因。
![1-4]() \
接着，根据先前的研究，获取了肺腺癌主要分类的生物标记基因。通过DimPlot图对19个细胞类群进行注释，得到单细胞三个主要类群（上皮、免疫、基质细胞）。并查看每个样本中，三类细胞所占的比例，上皮细胞在肿瘤患者中占比更高，符合生物学常识。 \
![1-5]() \
